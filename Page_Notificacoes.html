<div class="fade-in space-y-6">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-xl font-bold text-slate-800">Fila de Disparos (WhatsApp)</h2>
    <button onclick="carregarZap()" class="text-blue-500"><i class="fas fa-sync"></i></button>
  </div>

  <div id="lista-zap" class="space-y-3">
    <p class="text-center py-10 text-slate-400">Calculando regras de envio...</p>
  </div>
</div>

<script>
  window.carregarZap = function() {
    const container = document.getElementById('lista-zap');
    
    google.script.run.withSuccessHandler(lista => {
      container.innerHTML = '';
      
      if (lista.length === 0) {
        container.innerHTML = '<div class="p-4 bg-green-50 text-green-700 rounded text-center">Nenhum envio pendente hoje.</div>';
        return;
      }

      lista.forEach(item => {
        // Define cor baseada na regra das 15h
        const isAmanha = item.status.includes("Amanh√£");
        const borderClass = isAmanha ? "border-orange-400" : "border-green-500";
        const bgBadge = isAmanha ? "bg-orange-100 text-orange-700" : "bg-green-100 text-green-700";

        const card = document.createElement('div');
        card.className = `bg-white p-4 rounded shadow-sm border-l-4 ${borderClass} flex justify-between items-center`;
        
        card.innerHTML = `
          <div class="flex-1 pr-4">
            <div class="flex items-center gap-2 mb-1">
              <span class="text-[10px] font-bold px-2 py-0.5 rounded ${bgBadge}">${item.status}</span>
              <span class="font-bold text-slate-700">${item.cliente}</span>
            </div>
            <p class="text-xs text-slate-500 mb-2">Proc: ${item.processo}</p>
            <div class="bg-slate-50 p-2 rounded text-xs text-slate-600 italic border border-slate-100">
               "${item.interpretacao}"
            </div>
          </div>
          
          <a href="${item.linkZap}" target="_blank" class="flex flex-col items-center justify-center w-12 h-12 bg-green-50 text-green-600 rounded-full hover:bg-green-500 hover:text-white transition">
            <i class="fab fa-whatsapp text-xl"></i>
          </a>
        `;
        container.appendChild(card);
      });

    }).apiGetFilaWhatsapp(); // Lembre de adicionar esta ponte no Controller
  };

  (function(){ carregarZap(); })();
</script>
